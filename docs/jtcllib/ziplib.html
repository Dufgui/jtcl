<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- Generated by Apache Maven Doxia at Aug 30, 2014 -->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=US-ASCII" />
    <title></title>
    <style type="text/css" media="all">
      @import url("../../css/maven-base.css");
      @import url("../../css/maven-theme.css");
      @import url("../../css/site.css");
    </style>
    <link rel="stylesheet" href="../../css/print.css" type="text/css" media="print" />
    <meta name="Date-Revision-yyyymmdd" content="20140830" />
    <meta http-equiv="Content-Language" content="en" />
        
        </head>
  <body class="composite">
    <div id="banner">
                        <a href="https://jtcl-project.github.io/jtcl/" id="bannerLeft">
                                                <img src="../../images/jtcl-horz-med.png" alt="JTcl" />
                </a>
                    <div class="clear">
        <hr/>
      </div>
    </div>
    <div id="breadcrumbs">
            
        
                <div class="xleft">
        <span id="publishDate">Last Published: 2014-08-30</span>
                  &nbsp;| <span id="projectVersion">Version: 2.7.0</span>
                      </div>
            <div class="xright">                    <a href="http://www.tcl.tk/" class="externalLink" title="Tcl">Tcl</a>
            |
                        <a href="http://www.oracle.com/technetwork/java/index.html" class="externalLink" title="Java">Java</a>
              
        
      </div>
      <div class="clear">
        <hr/>
      </div>
    </div>
    <div id="leftColumn">
      <div id="navcolumn">
             
        
                                <h5>JTcl Links</h5>
                  <ul>
                  <li class="none">
                          <a href="https://github.com/jtcl-project/jtcl/releases" class="externalLink" title="Download">Download</a>
            </li>
                  <li class="none">
                          <a href="../../news.html" title="News">News</a>
            </li>
                  <li class="none">
                          <a href="../../gettingstarted.html" title="Getting Started">Getting Started</a>
            </li>
                  <li class="none">
                          <a href="../../docs/index.html" title="Documentation">Documentation</a>
            </li>
                  <li class="none">
                          <a href="../../faq.html" title="FAQ">FAQ</a>
            </li>
                  <li class="none">
                          <a href="../../projects.html" title="Projects Using JTcl">Projects Using JTcl</a>
            </li>
                  <li class="none">
                          <a href="https://github.com/jtcl-project/jtcl/issues" class="externalLink" title="Bugs">Bugs</a>
            </li>
                  <li class="none">
                          <a href="https://groups.google.com/forum/#!forum/jtcl-project" class="externalLink" title="Mailing Lists">Mailing Lists</a>
            </li>
                  <li class="none">
                          <a href="https://github.com/jtcl-project/jtcl/" class="externalLink" title="Source Code">Source Code</a>
            </li>
                  <li class="none">
                          <a href="https://github.com/jtcl-project/jtcl" class="externalLink" title="Project Page">Project Page</a>
            </li>
                  <li class="none">
                          <a href="../../licenses.html" title="License">License</a>
            </li>
          </ul>
                             <a href="http://maven.apache.org/" title="Built by Maven" class="poweredBy">
        <img class="poweredBy" alt="Built by Maven" src="../../images/logos/maven-feather.png" />
      </a>
                   
        
            </div>
    </div>
    <div id="bodyColumn">
      <div id="contentBox">
        <div class="section"><h2>Ziplib<a name="Ziplib"></a></h2><!-- ~~ --><p>Ziplib reads and writes ZIP and JAR files. ZIP files are stream based. None of the procedures in this package close the <i>zipin</i> or <i>zipout</i> objects, so the programmer should close the zip stream after processing. Note that the objects returned by <i>::ziplib::openInputZip</i> and <i>::ziplib::openOutputZip</i> are java objects, not Tcl channels.</p><p>See also: </p><ul><li><a class="externalLink" href="http://docs.oracle.com/javase/1.5.0/docs/api/java/util/zip/package-summary.html">java.util.zip javadocs</a></li><li><a class="externalLink" href="http://docs.oracle.com/javase/1.5.0/docs/api/java/io/InputStream.html">java.io.InputStream javadocs</a></li><li><a class="externalLink" href="http://docs.oracle.com/javase/1.5.0/docs/api/java/io/OutputStream.html">java.io.OutputStream javadocs</a></li></ul></div><div class="section"><h2>Usage<a name="Usage"></a></h2><p>Include the <b>ziplib</b> package in Tcl source files:</p><div class="source"><pre>    package require ziplib</pre></div></div><div class="section"><h2>Ziplib Commands<a name="Ziplib_Commands"></a></h2><div class="section"><h3>::ziplib::openInputZip<a name="a::ziplib::openInputZip"></a></h3><p>::ziplib::openInputZip <i>fileName</i></p><p>Open the <i>fileName</i> for reading and return a <b>java.util.zip.ZipInputStream</b> object. A Tcl error is thrown if the file is not found, or if the file is not a valid ZIP or JAR file. Note that the object returned by ::ziplib::openInputZip should be closed after processing the zip stream. </p></div><div class="section"><h3>::ziplib::openOutputZip<a name="a::ziplib::openOutputZip"></a></h3><p>::ziplib::openOutputZip <i>fileName</i></p><p>Open the <i>fileName</i> for writing and return a <b>java.util.zip.ZipOutputStream</b> object. A Tcl error is thrown if the file could not be opened. Any existing file is overwritten. Note that the object returned by ::ziplib::openOutputZip should be closed after processing the zip stream.</p></div><div class="section"><h3>::ziplib::copyZip<a name="a::ziplib::copyZip"></a></h3><p>::ziplib::openOutputZip <i>zipin</i> <i>zipout</i> <i>?excludeReList?</i></p><p>Copy a ZIP file to another file. <i>zipin</i> must be an object returned by ::ziplib::openInputZip; <i>zipout</i> must be an object returned by ::ziplib::openOutputZip. <i>excludeReList</i> is an optional Tcl list of regular expressions. If any regular expression matches a ZIP entry, that entry is not copied to the output zip.</p></div><div class="section"><h3>::ziplib::unzipToDir <a name="a::ziplib::unzipToDir"></a></h3><p>::ziplib::unzipToDir <i>zipin</i> <i>dir</i></p><p>Unzip a ZIP archive to a directory. <i>zipin</i> must be an object returned by ::ziplib::openInputZip. <i>dir</i> is the name of a directory to which files are written. If <i>dir</i> does not exists, it will be created.</p></div><div class="section"><h3>::ziplib::zipFromDir <a name="a::ziplib::zipFromDir"></a></h3><p>::ziplib::zipFromDir <i>zipout</i> <i>dir</i> <i>?zipTopLevel?</i></p><p>Recursively writes the contents of a directory into a zip file. <i>zipout</i> must be an object returned by ::ziplib::openOutputZip. <i>dir</i> is the name of a directory, which must exist. <i>zipTopLevel</i> is an optional directory that specifies the top level directory entry of the zip file. </p></div><div class="section"><h3>::ziplib::mkZipFile <a name="a::ziplib::mkZipFile"></a></h3><p>::ziplib:: mkZipFile <i>zipout</i> <i>fileName</i></p><p>Make a new file entry in the zip file. <i>zipout</i> must be an object returned by ::ziplib::openOutputZip. <i>fileName</i> is the name of the new file entry. The <i>zipout</i> may be use to write file data after performing this procedure.</p></div><div class="section"><h3>::ziplib::mkZipDir <a name="a::ziplib::mkZipDir"></a></h3><p>::ziplib::mkZipDir <i>zipout</i> <i>dirName</i></p><p>Make a new directory entry in the zip file. <i>zipout</i> must be an object returned by ::ziplib::openOutputZip. <i>dirName</i> is the name of the new directory entry.</p></div><div class="section"><h3>::ziplib::copyStream<a name="a::ziplib::copyStream"></a></h3><p>::ziplib::copyStream <i>in</i> <i>out</i></p><p>Copies the bytes from an input stream to an output stream. <i>in</i> is a Java object that supports the <b>java.io.InputStream read</b> method. <i>out</i> is a Java object that support the <b>java.io.OutStream write</b> method. <i>in</i> is typically FileInputStream or ZipInputStream objects, <i>out</i> is typically FileOutputStream or ZipOutStream objects.</p></div><div class="section"><h3>::ziplib::getClassLocation<a name="a::ziplib::getClassLocation"></a></h3><p>::ziplib::getClassLocation <i>class</i></p><p>Returns the location of a class, typically used to find which JAR file or directory from which a class was loaded. If the location is a JAR or directory, that pathname of the location is return, otherwise, the location is prefixed with a URI resource type (e.g., &quot;xxx:&quot;) denoting the class was loaded from other than a file or JAR.</p></div></div><div class="section"><h2>Examples<a name="Examples"></a></h2><p>Copy a zip file to a new file</p><div class="source"><pre>    package require ziplib

    set zipin  [::ziplib::openInputZip some.zip]
    set zipout [::ziplib::openOutputZip new.zip]
    ::ziplib::copyZip $zipin $zipout
    $zipin close
    $zipout close</pre></div><p>Print all of the file and directory entries from a zip file</p><div class="source"><pre>    package require ziplib

    set zipin  [::ziplib::openInputZip some.zip]
    while {! [java::isnull [set entry [$zipin getNextEntry]]] } {
        puts [$entry getName]
    }
    $zipin close</pre></div><p>Write zip file entries</p><div class="source"><pre>    package require ziplib

    set zipout  [::ziplib::openOutputZip some.zip]

    set bytes [[java::new String &quot;hello world from JTcl and ziplib\n&quot;] getBytes]
    ::ziplib::mkZipFile $zipout  hello-world.txt
    $zipout write $bytes

    set bytes [[java::new String &quot;another file\n&quot;] getBytes]
    ::ziplib::mkZipDir $zipout  sub-dir
    ::ziplib::mkZipFile $zipout  sub-dir/other-file.txt
    $zipout write $bytes

    $zipout close</pre></div><p>Read a zip file entry</p><div class="source"><pre>    package require ziplib

    set zipin  [::ziplib::openInputZip some.zip]
    set buf [java::new {byte[]} 32768]
    while { ! [java::isnull [set entry [$zipin getNextEntry]]] } {
        # only print entries with a &quot;.txt&quot; suffix
        if { [regexp {.txt$} [$entry getName]] }  {
            puts &quot;\ncontents of [$entry getName]&quot;
            puts &quot;-----------------------&quot;
            while { [set bytesRead [$zipin read $buf]] &gt; 0 } {
                set str [java::new {String byte[] int int} $buf 0 $bytesRead]
                puts -nonewline [$str toString]
            }
            puts &quot;\n-----------------------&quot;
        } else {
            puts &quot;skipping entry: [$entry getName]&quot;
        }
    }
    $zipin close</pre></div><p>Find the JAR file that contains the JTcl Interp class</p><div class="source"><pre>    package require ziplib

    puts [::ziplib::getClassLocation [java::getinterp]]</pre></div></div>
      </div>
    </div>
    <div class="clear">
      <hr/>
    </div>
    <div id="footer">
      <div class="xright">
              Copyright &#169;                   2014.
          All Rights Reserved.      
        
                  </div>
      <div class="clear">
        <hr/>
      </div>
    </div>
  </body>
</html>
